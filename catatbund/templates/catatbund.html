{% extends 'base.html' %}

{% block meta %}
<title>To Do List</title>
{% endblock meta %}

{% block content %}

<style>
    body {
       background-color: aquamarine;
    }   
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  $(document).ready(function(){
    //ini kan buat nampilin data yang dulu udh ada gt kn
      $.get("/catatbund/json", function(data) {
        console.log(data)
        for (i=0; i < data.length; i++){
            $(".row").append(`<div class="flex justify-center">
            <div class="block p-6 rounded-lg shadow-lg bg-white max-w-sm">
                <h5 class="text-gray-900 text-xl leading-tight font-medium mb-2">Tanggal: ${data[i].fields.date}</h5>
                <p class="text-gray-700 text-base mb-4">Berat badan(kg): ${data[i].fields.weight}</p>
                <p class="text-gray-700 text-base mb-4">Tinggi badan(m): ${data[i].fields.height}</p>
                <p class="text-gray-700 text-base mb-4">BMI: ${data[i].fields.bmi}</p>
                <button id="edit-btn" data-bs-target="#editModal" type="button" class=" inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">Edit</button>
            </div>
            </div>`)
            }
      });

      $("#unggah-btn").click(function(){
      $.post("/catatbund/add/", 
        $('#input-form').serialize(),
        function (res){
          $(".row").append(`<div class="flex justify-center">
            <div class="block p-6 rounded-lg shadow-lg bg-white max-w-sm">
                <h5 class="text-gray-900 text-xl leading-tight font-medium mb-2">Tanggal: ${res.fields.date}</h5>
                <p class="text-gray-700 text-base mb-4">Berat badan(kg): ${res.fields.weight}</p>
                <p class="text-gray-700 text-base mb-4">Tinggi badan(m): ${res.fields.height}</p>
                <p class="text-gray-700 text-base mb-4">BMI: ${res.fields.bmi}</p>
                <button id="edit-btn" data-bs-target="#editModal" type="button" class=" inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">Edit</button>
            </div>
            </div>`)
        }
        )
        
      })

  });
</script>

<body>
<h1>Catatbund</h1>
<h3>Hi {{user}}</h3>
<br>

<div class="row p-10 grid grid-cols-1 sm:grid-cols-1 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-3 gap-5">

</div>

<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@mdo">Tambah Catatan</button>
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Tambah Catatan</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="input-form">
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Berat Badan(kg):</label>
              <br>
              {{ form.weight }}
            </div>
            <div class="mb-3">
              <label for="message-text" class="col-form-label">Tinggi Badan(m):</label>
              {{ form.height }}
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="unggah-btn">Unggah</button>
        </div>
      </div>
    </div>
  </div>

  
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="editModalLabel">Tambah Catatan</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="input-form">
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Berat Badan(kg):</label>
                <br>
                {{ form.weight }}
                </div>
                <div class="mb-3">
                <label for="message-text" class="col-form-label">Tinggi Badan(m):</label>
                {{ form.height }}
              </div>
          </form>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="unggah-btn">Unggah</button>
        </div>
    </div>
    </div>
  </div>
  
</body>
{% endblock content %}